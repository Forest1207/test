# 差异分析

[TOC]

### 一、多变量分析

#### 1.PCA(主成分分析，无监督)

​	PCA是一种使用最广泛的**数据降维算法**，先找出数据X矩阵的方差最大方向作为PC1，在与PC1正交的平面中找出使得方差最大的作为PC2，依次类推。从而建立低维平面或空间（通常2~5维)，以此分析和概览整个数据集。PCA不是一种分类方法，但能提供对复杂数据集的直观解释，并从中揭示出数据集中观测数据的分组、趋势以及离群。对明显不同于大部分样品的离群样品，可加以甄别或剔除。如图2所示。另外，如果存在质控样品，PCA还可进行质控，如果质控样品很分散或具有一定的变化趋势，则说明检测质量存在一定的问题。

<img src="..\images\image-20251116185755232.png" alt="image-20251116185755232" style="zoom:50%;" />

#### 2.PLS-DA（偏最小二乘判别分析，有监督）

​	PLS-DA**在降维的同时结合了回归模型，并利用一定的判别阈值对回归结果进行判别分析**。通过多元线性回归技术来找到数据集(X)和类别数据集(Y)之间的最大协方差的方向，建立两个独立数据集(X-Y)潜在关联分析方法，即基于X变量数据信息，建立Y 变量预测模型(X-Y)。
​	这种模型计算的方法强行把各组分开，有利于发现不同组间的异同点。**对于组间差异不够明显的样品，采用PCA 方法常常无法区分样品的组间差异**，这种情况下采用PLS-DA 模型可能更加有效。同时也能识别潜在的生物标记物，适用于两组或者两组以上分析，在需要同时观察多组别样品相似性和差异性时体现更大价值。但是如果主成分过多或分组过于复杂而出现过拟合现象 (over-fitting)，会造成模型失真，在实际数据分析时应注意验证模型有效性和可靠性。

<img src="D:\2.XX\study\shtl\images\image-20251116190215718.png" alt="image-20251116190215718" style="zoom:50%;" />

#### 3.OPLS-DA（正交偏最小二乘判别分析，有监督）

​	**数据集X总会含有一些与研究无关的干扰信号**，如人的生活方式，植物的生长环境或检测仪器的噪音干扰等。若能滤掉这些噪音会有助于发现最重要的变量，提高模型的有效性。
​	与PLS相比，OPLS根据数据集Y的差异将数据集X的差异分为两个部分，第一部分代表与Y相关的差异，第二部分代表与Y不相关 （正交垂直）的差异，OPLS-DA可将这两部分差异进行区分，控制与Y正交或者无关的X的变化并加以滤除。通过这种方式，OPLS-DA 可以更好地**区分组间差异，提高模型的有效性和解析能力**。如图4所示，OPLS-DA将组间差异主要集中在第一个预测主成分上，即X轴。**OPLS-DA常用于对两组样品的代谢组学数据进行判别分析，能清晰展现组间样品差别并能直接解释和识别潜在的生物标志物。**

<img src="C:\Users\王艺骏\AppData\Roaming\Typora\typora-user-images\image-20251116190544741.png" alt="image-20251116190544741" style="zoom:50%;" />

​	通过**OPLS-DA**分析，提取代谢物**VIP（Variable Importance in Projection）**值用于后续**关键代谢物筛选**。

### 二.单变量分析

#### 1.t检验

用于判断代谢物在两组间的均值是否有显著差异（FDR校正后P < 0.05）。

#### 2.FoldChange

用于判断对照组与实验组之间代谢物含量的变化倍数（log2FC>1或log2FC<-1作为筛选标准）。

### 三.绘图

#### 1.条形图

​	差异代谢物条形图直观展示了不同代谢物的相对变化程度。差异代谢物条形图中横坐标为差异代谢物的log2FC，纵坐标为差异代谢物，红色代表代谢物含量上调，蓝色代表代谢物含量下调，条形的长度直观体现了变化倍数的大小。

<img src="..\images\image-20251116191933872.png" alt="image-20251116191933872" style="zoom:50%;" />

#### 2.火山图

​	火山图中的每一个点表示一种代谢物，其中蓝色的点代表下调差异代谢物，红色的点代表上调差异代谢物，灰色的点代表检测到但差异不显著的代谢物。横坐标为log2FC，绝对值越大，表示该代谢物在两组样品间的表达量倍数差异越大。纵坐标为-log10(P value)，数值越高，表明差异表达越显著，筛选得到的差异表达代谢物越可靠。可依据图中差异代谢物的总数，优先关注上、下调最显著的前50%差异代谢物，系统检索其生物学功能，并结合研究目标对关键候选物进行后续实验验证。

<img src="..\images\image-20251116192209420.png" alt="image-20251116192209420" style="zoom:50%;" />

#### 3.ROC曲线

用于评价算选出的标记物的诊断能力。AUC曲线下面积越大，诊断能力越好

<img src="..\images\image-20251116192359250.png" alt="image-20251116192359250" style="zoom:50%;" />

#### 4.相关性热图

​	差异代谢物相关性热图通过计算差异代谢物两两之间的皮尔逊相关系数来分析各个代谢物间的相关性。横向、纵向都为差异代谢物名称，不同颜色为皮尔逊相关系数r高低，红色表示正相关性，蓝色表示负相关性，颜色越深相关性越高。

<img src="..\images\image-20251116192549132.png" alt="image-20251116192549132" style="zoom:50%;" />

#### 5.和弦图

​	和弦图可让两个代谢组物之间的相互关系可视化。图中最外层为差异代谢物名称，点的大小代表对应差异代谢物的log2FC值的大小，不同分类的差异代谢物用不同颜色表示；红色线条代表正相关，蓝色线条代表负相关，颜色越深相关性越高。

<img src="..\images\image-20251116193152434.png" alt="image-20251116193152434" style="zoom:50%;" />

#### 6.差异代谢物聚类热图

​	差异代谢物聚类热图同时展示代谢物表达模式，并对代谢物和/或样本进行无监督聚类。图中横坐标为样品信息，纵坐标为代谢物信息，代谢物相对含量标准化处理后得到的数值用不同颜色区分，含量越高颜色越红，含量越低颜色越蓝，Group为分组。

<img src="..\images\image-20251116193418983.png" alt="image-20251116193418983" style="zoom:50%;" />

#### 7.K-Means图

​	K-Means分析可直观反映代谢物在不同分组中的相对含量变化趋势，可识别出具有相同动态变化模式的代谢物群体。K-Means分析图中横坐标为样品名称，纵坐标为标准化的代谢物相对含量，Cluster表示变化趋势相同的代谢物类别编号，数字表示该类别的代谢物的总数目。

<img src="..\images\image-20251116193708225.png" alt="image-20251116193708225" style="zoom:50%;" />

### **四.ST000355结果展示**

#### **PCA**

![PCA5](..\images\PCA5.png)

<img src="..\images\PCA4.png" alt="PCA4" style="zoom:40%;" />

#### **PLS/OPLS-DA**

```R
library(ropls)#用于PLS/OPLS-DA
data.plsda <- opls(t(clean_data), Group)
data.oplsda <- opls(t(clean_data), Group,predI = 1, orthoI = NA)
```

![PLS_DA](..\images\PLS_DA.png)

![OPLS_DA](..\images\OPLS_DA.png)

#### **火山图**

![volcano_plot](..\images\volcano_plot.png)